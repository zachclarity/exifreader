
<!doctype html>
<html>
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<script src="https://cdn.tailwindcss.com"></script>
<title>Upload</title>
</head>
<body class="bg-gray-50">
<div class="max-w-xl mx-auto p-6">
<div class="bg-white p-6 rounded-2xl shadow">
<h1 class="text-xl font-bold">LocalStack Upload</h1>

<input id=file type=file class="mt-4 block w-full border rounded p-2"/>

<div class="mt-4 bg-gray-100 p-3 rounded">
<div>Name: <span id=name>-</span></div>
<div>Type: <span id=type>-</span></div>
<div>Size: <span id=size>-</span></div>
</div>

<button id=upload class="mt-4 w-full bg-indigo-600 text-white py-2 rounded">Upload</button>
<div id=status class="mt-3 text-sm"></div>
</div>
</div>

<script>
const f=document.getElementById("file");
const name=document.getElementById("name");
const type=document.getElementById("type");
const size=document.getElementById("size");
const status=document.getElementById("status");
const btn=document.getElementById("upload");

f.onchange=()=>{
 const file=f.files[0];
 if(!file) return;
 name.textContent=file.name;
 type.textContent=file.type;
 size.textContent=(file.size/1024).toFixed(1)+" KB";
}

async function cfg(){
 return (await fetch("config.json")).json();
}

btn.onclick=async()=>{
 const file=f.files[0];
 if(!file) return;

 status.textContent="Getting upload URL...";

 const {functionUrl}=await cfg();

 const r=await fetch(functionUrl,{
  method:"POST",
  headers:{'content-type':'application/json'},
  body:JSON.stringify({filename:file.name,contentType:file.type})
 });

 const j=await r.json();

 status.textContent="Uploading...";

 await fetch(j.uploadUrl,{
  method:"PUT",
  headers:{'Content-Type':file.type},
  body:file
 });

 status.textContent="Upload complete: "+j.key;
}
</script>
</body>
</html>
